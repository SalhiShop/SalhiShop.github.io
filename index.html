<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Salhi Shop</title>
  <link rel="stylesheet" href="style.css">
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyByfz30HgKDfynhOXb24hSOReTJOfk77mI",
      authDomain: "salhishop-1.firebaseapp.com",
      projectId: "salhishop-1",
      storageBucket: "salhishop-1.firebasestorage.app",
      messagingSenderId: "784629559774",
      appId: "1:784629559774:web:388f9ca4c33e90d6fcad4f",
      measurementId: "G-34G9453E7H"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const profilePic = document.getElementById("profilePic");
    const userName = document.getElementById("userName");
    const loginBtn = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logoutBtn");

    onAuthStateChanged(auth, (user) => {
      if (user && user.emailVerified) {
        profilePic.src = user.photoURL || "default-avatar.png";
        userName.innerText = user.displayName || user.email;
        loginBtn.style.display = "none";
        logoutBtn.style.display = "inline-block";
      } else {
        profilePic.src = "default-avatar.png";
        userName.innerText = "Invité";
        loginBtn.style.display = "inline-block";
        logoutBtn.style.display = "none";
      }
    });

    function logout() {
      signOut(auth).then(() => {
        alert("Déconnecté avec succès !");
      });
    }
  </script>
</head>
<body>
  <header class="header">
    <h1>Salhi Shop</h1>
    <div>
      <img id="profilePic" src="default-avatar.png" alt="Profil" class="avatar">
      <span id="userName">Invité</span>
      <button id="loginBtn" onclick="window.location.href='login.html'">Se connecter</button>
      <button id="logoutBtn" onclick="logout()" style="display:none;">Se déconnecter</button>
    </div>
  </header>

  <main class="content">
    <h2>Bienvenue sur Salhi Shop !</h2>
    <p>Découvrez nos produits et promotions.</p>

    <section id="commandes">
      <h3>Passer une commande</h3>
      <button onclick="passerCommande()">Commander</button>
    </section>
  </main>

  <script>
    function passerCommande() {
      const auth = firebase.auth();
      const user = auth.currentUser;
      if (!user || !user.emailVerified) {
        alert("Vous devez être connecté et avoir vérifié votre email pour passer une commande.");
        return;
      }
      alert("Commande en cours !");
      // Ici tu peux ajouter l’intégration Firebase pour les commandes
    }
  </script>
</body>
</html>
